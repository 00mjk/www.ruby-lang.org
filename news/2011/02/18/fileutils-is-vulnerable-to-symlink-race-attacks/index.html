---
layout: page
title: FileUtils is vulnerable to symlink race attacks
---

<p>A symlink race condition vulnerability was found in
FileUtils.remove_entry_secure.  The vulnerability allows local users
to delete arbitrary files and directories.</p>
<div id="extended">
<h3>Affected versions</h3>

<ul>
<li>Ruby 1.8.6 patchlevel 420 and all prior versions</li>
<li>Ruby 1.8.7 patchlevel 330 and all prior versions</li>
<li>Development versions of Ruby 1.8 (1.8.8dev)</li>
<li>Ruby 1.9.1 patchlevel 430 and all prior versions</li>
<li>Ruby 1.9.2 patchlevel 136 and all prior versions</li>
<li>Development versions of Ruby 1.9 (1.9.3dev)</li>
</ul>
<h3>Solutions</h3>

<p>We have fixed this situation.  All affected users are encouraged to upgrade their ruby installation.</p>

<p>But please also note, that symlink race attacks are unavoidable when any of upper directories from where you want to delete are owned by someone you cannot trust.  So if you want to be secure, you must ensure that <strong>ALL</strong> parent directories cannot be moved by other untrusted users.  For example, parent directories should not be owned by untrusted users, and should not be world writable except when the sticky bit set.</p>

<h3>Updates</h3>

<ul>
<li>Fixed typo. (vulnerabile -&gt; vulnerable)</li>
<li>1.8.7-334 was released to fix this issue.
1.8.7 users are encouraged to upgrade.
<ul>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.7-p334.tar.gz">ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.7-p334.tar.gz</a></li>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.7-p334.tar.bz2">ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.7-p334.tar.bz2</a></li>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.7-p334.zip">ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.7-p334.zip</a></li>
</ul>
</li>
<li>1.9.1-p431 was released to fix this issue.
1.9.1 users are encouraged to upgrade.
<ul>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p431.tar.gz">ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p431.tar.gz</a></li>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p431.tar.bz2">ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p431.tar.bz2</a></li>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p431.zip">ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p431.zip</a></li>
</ul>
</li>
<li>1.9.2-p180 was released to fix this issue.
1.9.2 users are encouraged to upgrade.
<ul>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p180.tar.gz">ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p180.tar.gz</a></li>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p180.tar.bz2">ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p180.tar.bz2</a></li>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p180.zip">ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p180.zip</a></li>
</ul>
</li>
<li>Fixed affected versions for 1.9 series.</li>
</ul>
</div>
            

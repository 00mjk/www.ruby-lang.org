---
layout: page
title: Net::HTTPS Vulnerability
---

<p>A vulnerability on the net/https library was reported.</p>
<p>Detailed information should be found at the original advisory:
<a href="http://www.isecpartners.com/advisories/2007-006-rubyssl.txt">&lt;URL:http://www.isecpartners.com/advisories/2007-006-rubyssl.txt&gt;</a></p>
<div id="extended">
<h4><a name="label-0" id="label-0">Impact</a></h4>
<!-- RDLabel: "Impact" --><p>The vulnerability exists in the connect method within http.rb file which
fails to call post_connection_check after the SSL connection has been 
negotiated.  Since the server certificate's CN is not validated against 
the requested DNS name, the attacker can impersonate the target server 
in a SSL connection.  The integrity and confidentiality benefits of 
SSL are thereby eliminated.</p>
<h4><a name="label-1" id="label-1">Vulnerable versions</a></h4>
<!-- RDLabel: "Vulnerable versions" --><dl>
<dt><a name="label-2" id="label-2">1.8 series</a></dt>
<!-- RDLabel: "1.8 series" -->
<dd>
<ul>
<li>1.8.4 and all prior versions</li>
<li>1.8.5-p113 and all prior versions</li>
<li>1.8.6-p110 and all prior versions</li>
</ul>
</dd>
<dt><a name="label-3" id="label-3">Development version (1.9 series)</a></dt>
<!-- RDLabel: "Development version (1.9 series)" -->
<dd>
All versions before 2006-09-23
</dd>
</dl>
<h4><a name="label-4" id="label-4">Solution</a></h4>
<!-- RDLabel: "Solution" --><dl>
<dt><a name="label-5" id="label-5">1.8 series</a></dt>
<!-- RDLabel: "1.8 series" -->
<dd>
<p>Please upgrade to 1.8.6-p111 or 1.8.5-p114.</p>
<ul>
<li><a href="http://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.6-p111.tar.gz">&lt;URL:http://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.6-p111.tar.gz&gt;</a></li>
<li><a href="http://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.5-p114.tar.gz">&lt;URL:http://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.5-p114.tar.gz&gt;</a></li>
</ul>
<p>Then you should use Net::HTTP#enable_post_connection_check= to enable post_connection_check.</p>
<pre>http = Net::HTTP.new(host, 443)
http.use_ssl = true
http.enable_post_connection_check = true
http.verify_mode = OpenSSL::SSL::VERIFY_PEER
store = OpenSSL::X509::Store.new
store.set_default_paths
http.cert_store = store
http.start {
  response = http.get("/")
}</pre>
<p>Please note that a package that corrects this weakness may already be available through your package management software. </p>
</dd>
<dt><a name="label-6" id="label-6">Development version (1.9 series)</a></dt>
<!-- RDLabel: "Development version (1.9 series)" -->
<dd>
Please update your Ruby to a version after 2006-09-23.
The default value of Net::HTTP#enable_post_connection_check is true on Ruby 1.9.
</dd>
</dl>
<h4><a name="label-7" id="label-7">Changes</a></h4>
<!-- RDLabel: "Changes" --><ul>
<li>2007-10-04 16:30 +09:00  added description for enable_post_connection_check to `Solution'.</li>
</ul>
</div>
            

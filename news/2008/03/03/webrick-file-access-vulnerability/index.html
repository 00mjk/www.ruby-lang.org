---
layout: page
title: File access vulnerability of WEBrick
---

<p>WEBrick, a standard library of Ruby to implement HTTP servers, has file
access vulnerability.</p>
<div id="extended">
<h2><a name="label-0" id="label-0">Impact</a></h2>
<!-- RDLabel: "Impact" --><p>The following programs are vulnerable.</p>
<ol>
<li>Programs that publish files using <code>WEBrick::HTTPServer.new</code>
      with the <code>:DocumentRoot</code> option</li>
<li>Programs that publish files using <code>WEBrick::HTTPServlet::FileHandler</code>
</li>
</ol>
<p>Affected systems are:</p>
<ol>
<li>Systems that accept backslash (\) as a path separator,
      such as Windows.</li>
<li>Systems that use case insensitive filesystems such
      as NTFS on Windows, HFS on Mac OS X.</li>
</ol>
<p>This vulnerability has the following impacts.</p>
<ol>
<li>
<p>Attacker can access private files by sending a url
      with url encoded backslash (\).
      This exploit works only on systems that accept
      backslash as a path separator.</p>
<p>Example:</p>
<pre>http://[server]:[port]/..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/boot.ini</pre>
</li>
<li>Attacker can access files that matches to the patterns
      specified by the <code>:NondisclosureName</code> option (the
      default value is <code>[".ht*", "*~"]</code>).
      This exploit works only on systems that use case
      insensitive filesystems.</li>
</ol>
<h2><a name="label-1" id="label-1">Vulnerable versions</a></h2>
<!-- RDLabel: "Vulnerable versions" --><dl>
<dt><a name="label-2" id="label-2">1.8 series</a></dt>
<!-- RDLabel: "1.8 series" -->
<dd>
<ul>
<li>1.8.4 and all prior versions</li>
<li>1.8.5-p114 and all prior versions</li>
<li>1.8.6-p113 and all prior versions</li>
</ul>
</dd>
<dt><a name="label-3" id="label-3">1.9 series</a></dt>
<!-- RDLabel: "1.9 series" -->
<dd>
<ul>
<li>1.9.0-1 and all prior versions</li>
</ul>
</dd>
</dl>
<h2><a name="label-4" id="label-4">Solution</a></h2>
<!-- RDLabel: "Solution" --><dl>
<dt><a name="label-5" id="label-5">1.8 series</a></dt>
<!-- RDLabel: "1.8 series" -->
<dd>
Please upgrade to 1.8.5-p115 or 1.8.6-p114.
<ul>
<li>
<a href="ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.5-p115.tar.gz">&lt;URL:ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.5-p115.tar.gz&gt;</a>
      (md5sum: 20ca6cc87eb077296806412feaac0356)</li>
<li>
<a href="ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.6-p114.tar.gz">&lt;URL:ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.6-p114.tar.gz&gt;</a>
      (md5sum: 500a9f11613d6c8ab6dcf12bec1b3ed3)</li>
</ul>
</dd>
<dt><a name="label-6" id="label-6">1.9 series</a></dt>
<!-- RDLabel: "1.9 series" -->
<dd>
Please apply the following patch to lib/webrick/httpservlet/filehandler.rb.
<ul>
<li>
<a href="ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.0-1-webrick-vulnerability-fix.diff">&lt;URL:ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.0-1-webrick-vulnerability-fix.diff&gt;</a>
      (md5sum: b7b58aed40fa1609a67f53cfd3a13257)</li>
</ul>
</dd>
</dl>
<p>Please note that a package that corrects this weakness may already be
available through your package management software.</p>
<h2><a name="label-7" id="label-7">Credit</a></h2>
<!-- RDLabel: "Credit" --><p>Credit to Digital Security Research Group (<a href="http://dsec.ru/">&lt;URL:http://dsec.ru/&gt;</a>)
for disclosing the problem to Ruby Security Team.</p>
</div>
            

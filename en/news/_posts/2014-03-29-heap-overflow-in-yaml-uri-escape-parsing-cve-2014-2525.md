---
layout: news_post
title: "Heap Overflow in YAML URI Escape Parsing (CVE-2014-2525)"
author: "hone and zzak"
translator:
date: 2014-03-29 01:49:25 +0000
lang: en
---

There is an overflow in URI escape parsing in Ruby. This vulnerability has been assigned the CVE identifier [CVE-2014-2525](http://www.ocert.org/advisories/ocert-2014-003.html).

## Details

Any time a string in YAML with tags is parsed, a specially crafted string can cause a heap overflow which can lead to arbitrary code execution.

For example:

```ruby
YAML.load <code_from_unknown_source>
```

## Affected Versions

Ruby 1.9.3-p0 and above include psych as the default YAML parser. Any version of psych linked against libyaml `<= 0.1.5` are affected.

You can verify the version of libyaml used by running:

```
$ ruby -rpsych -e 'p Psych.libyaml_version'
[0, 1, 5]
```

## Solutions

Users who install libyaml to the system are recommended to update libyaml to 0.1.6. When recompiling Ruby, point to the newly updated libyaml:

```
./configure --with-yaml-dir=/path/to/libyaml
```

Users without a system libyaml rely on the embedded libyaml and are recommended to update psych to `2.0.5` which vendors libyaml `0.1.6`.
